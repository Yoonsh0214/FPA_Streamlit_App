# 📘 FPA WebApp 사용 설명서

## 목차
- [시작하기](#시작하기)
- [기본 조작법](#기본-조작법)
- [액션 코드 전체 목록](#액션-코드-전체-목록)
- [태그 코드 전체 목록](#태그-코드-전체-목록)
- [스탯 입력 예시](#스탯-입력-예시)
- [키보드 단축키](#키보드-단축키)
- [자동 태그 규칙](#자동-태그-규칙)

---

## 시작하기

### 1. 경기 정보 입력
- **Match ID**: 경기 고유 번호
- **Home Team ID**: 홈팀 ID
- **Away Team ID**: 원정팀 ID

### 2. 경기 상황 선택
- **Half**: 1st (전반전) / 2nd (후반전)
- **Team**: Home (홈팀) / Away (원정팀)
- **Direction**: Right (오른쪽 공격) / Left (왼쪽 공격)

---

## 기본 조작법

### 🕐 시간 조정
- **수동 입력**: `MM:SS` 형식으로 직접 입력 (예: `15:30`)
- **버튼 클릭**: 
  - `+1분` 버튼: 1분 증가
  - `-1분` 버튼: 1분 감소
- **키보드 단축키**:
  - `↑` (위 화살표) 또는 `→` (오른쪽 화살표): +1분
  - `↓` (아래 화살표) 또는 `←` (왼쪽 화살표): -1분

### 🖱️ 좌표 입력
- **좌클릭**: 축구장 이미지를 클릭하여 좌표 추가 (주황색 점 표시)
- **우클릭**: 마지막에 찍은 좌표 삭제
- **자동 변환**: 픽셀 좌표 → 미터 단위 (105m × 68m)

### ⌨️ 스탯 코드 입력
**입력 형식**: `선수번호 + 액션코드 + 수신선수번호 + . + 태그코드1.태그코드2...`

**예시**:
- `10ss8.k` → 10번 선수가 8번 선수에게 키패스 (좌표 2개 필요)
- `9dd.wf` → 9번 선수가 약발로 골 (좌표 1개 필요)
- `7d` → 7번 선수가 슛 (좌표 1개 필요)

---

## 액션 코드 전체 목록

### 🎯 슈팅 관련
| 코드 | 액션 | 좌표 개수 | 설명 |
|------|------|----------|------|
| `ddd` | Goal | 1개 | 골 |
| `dd` | Shot On Target | 1개 | 유효슈팅 |
| `d` | Shot | 1개 | 슛 (빗나감 포함) |
| `db` | Blocked Shot | 1개 | 블락당한 슛 |

### ⚡ 패스 & 어시스트
| 코드 | 액션 | 좌표 개수 | 설명 |
|------|------|----------|------|
| `ss` | Pass (Success) | 2개 | 패스 성공 |
| `s` | Pass (Fail) | 2개 | 패스 실패 |
| `zz` | Assist | 2개 | 어시스트 |
| `z` | Key Pass | 2개 | 키패스 |
| `cc` | Cross (Success) | 2개 | 크로스 성공 |
| `c` | Cross (Fail) | 2개 | 크로스 실패 |

### 🏃 공격 플레이
| 코드 | 액션 | 좌표 개수 | 설명 |
|------|------|----------|------|
| `ee` | Breakthrough | 2개 | 돌파 |
| `rr` | Dribble | 1개 | 드리블 |
| `gp` | Gain | 1개 | 볼 획득 |
| `m` | Miss | 1개 | 컨트롤 미스 |

### 🛡️ 수비 플레이
| 코드 | 액션 | 좌표 개수 | 설명 |
|------|------|----------|------|
| `aa` | Tackle | 1개 | 태클 |
| `q` | Intercept | 1개 | 인터셉트 |
| `qq` | Acquisition | 1개 | 볼 탈취 |
| `w` | Clear | 1개 | 클리어링 |
| `ww` | Cutout | 1개 | 차단 |
| `qw` | Block | 1개 | 블록 |

### 🧤 골키퍼
| 코드 | 액션 | 좌표 개수 | 설명 |
|------|------|----------|------|
| `v` | Catching | 1개 | 캐칭 |
| `vv` | Punching | 1개 | 펀칭 |

### 🟨 기타
| 코드 | 액션 | 좌표 개수 | 설명 |
|------|------|----------|------|
| `bb` | Duel (Success) | 1개 | 경합 성공 |
| `b` | Duel (Fail) | 1개 | 경합 실패 |
| `f` | Foul | 1개 | 파울 |
| `ff` | Be Fouled | 1개 | 파울 당함 |
| `o` | Offside | 1개 | 오프사이드 |

---

## 태그 코드 전체 목록

### 🏷️ 수동 태그 (직접 입력)
| 코드 | 태그 | 설명 |
|------|------|------|
| `k` | Key | 키패스 (결정적 패스) |
| `a` | Assist | 어시스트 |
| `h` | Header | 헤더 |
| `r` | Aerial | 공중볼 경합 |
| `w` | Suffered | 파울 당함 |
| `n` | In-box | 박스 안 |
| `u` | Out-box | 박스 밖 |
| `p` | Progressive | 진전 패스 |
| `c` | Counter Attack | 역습 |
| `sw` | Switch | 사이드 전환 |
| `wf` | Weak Foot | 약발 |
| `ft` | First Time | 원터치 |

### 🤖 자동 태그 (시스템 자동 추가)
| 태그 | 조건 | 설명 |
|------|------|------|
| `Success` | 액션 코드가 2번 반복 (예: `ss`, `cc`, `dd`) | 성공 |
| `Fail` | 액션 코드가 1번만 (예: `s`, `c`, `d`) | 실패 |
| `Progressive` | 시작점 대비 10m 이상 전진한 패스 | 진전 패스 |
| `In-box` | 페널티 박스 내에서 이벤트 발생 | 박스 안 |
| `Out-box` | 슛이 박스 밖에서 발생 | 박스 밖 |

---

## 스탯 입력 예시

### 예시 1: 일반 패스
```
입력: 10ss8
의미: 10번 선수가 8번 선수에게 패스 성공
좌표: 2개 (시작점, 끝점)
자동 태그: Success
```

### 예시 2: 키패스
```
입력: 7ss9.k
의미: 7번 선수가 9번 선수에게 키패스
좌표: 2개
자동 태그: Success, Key
```

### 예시 3: 골
```
입력: 11ddd.wf
의미: 11번 선수가 약발로 골 성공
좌표: 1개 (슈팅 위치)
자동 태그: Success, Weak Foot, In-box 또는 Out-box
```

### 예시 4: 헤더 골
```
입력: 9ddd.h
의미: 9번 선수가 헤더로 골
좌표: 1개
자동 태그: Success, Header, In-box
```

### 예시 5: 크로스 (실패)
```
입력: 3c
의미: 3번 선수가 크로스했으나 실패
좌표: 2개
자동 태그: Fail
```

### 예시 6: 진전 패스
```
입력: 5ss6
의미: 5번 선수가 6번 선수에게 패스
좌표: 2개 (오른쪽 공격 기준 10m 이상 전진 시)
자동 태그: Success, Progressive (조건 충족 시)
```

### 예시 7: 역습 상황 골
```
입력: 10ddd.c.wf
의미: 10번 선수가 역습 상황에서 약발로 골
좌표: 1개
자동 태그: Success, Counter Attack, Weak Foot, In-box
```

### 예시 8: 태클
```
입력: 4aa
의미: 4번 선수가 태클
좌표: 1개
자동 태그: (없음)
```

---

## 키보드 단축키

### ⌨️ 시간 조정
| 키 | 기능 |
|----|------|
| `↑` (위 화살표) | 시간 +1분 |
| `↓` (아래 화살표) | 시간 -1분 |
| `→` (오른쪽 화살표) | 시간 +1분 |
| `←` (왼쪽 화살표) | 시간 -1분 |

> **주의**: 스탯 코드 입력 필드에 포커스가 있을 때는 작동하지 않습니다.

---

## 자동 태그 규칙

### 1. Success/Fail 태그
- **Success**: 액션 코드를 2번 반복 (`ss`, `dd`, `cc`, `aa`, 등)
- **Fail**: 액션 코드를 1번만 (`s`, `d`, `c`, `a`, 등)
- **예외**: `d`, `db`는 항상 Fail, `dd`, `ddd`는 항상 Success

### 2. Progressive Pass (진전 패스)
- **조건**: 패스 시작점보다 골라인 방향으로 10m 이상 전진
- **방향 고려**: Direction 설정(Left/Right)에 따라 자동 계산

### 3. In-box / Out-box
- **In-box**: 페널티 박스 내(골라인 기준 16.5m 이내, 너비 40.3m)에서 이벤트 발생
- **Out-box**: 슛이 박스 밖에서 발생한 경우에만 추가

---

## 데이터 분석 및 내보내기

### 📊 실시간 분석
1. 스탯을 계속 기록
2. `현재 로그 분석 및 Excel로 내보내기` 버튼 클릭
3. 엑셀 파일 다운로드 (`live_analyzed_data.xlsx`)

### 📁 파일 업로드 분석
1. `파일 업로드` 모드로 전환
2. 기존 엑셀 파일 업로드 ('Data' 시트 포함)
3. 자동 분석 후 새 파일 다운로드 (`uploaded_analyzed_data.xlsx`)

### 📈 엑셀 파일 구성
- **Data**: 전체 로그 및 분석 결과
- **Tableau_Pass**: Tableau 시각화용 변환 데이터
- **Pass_Summary**: 패스 요약 통계
- **Shooting_Summary**: 슈팅 요약 통계
- **Cross_Summary**: 크로스 요약 통계
- **Advanced_Summary**: 고급 지표 (드리블, 태클, 인터셉트 등)
- **Final_Stats**: 선수별 종합 능력치 점수

---

## 문제 해결

### ❓ 자주 묻는 질문

**Q: 좌표를 잘못 찍었어요.**  
A: 축구장에서 **우클릭**하면 마지막에 찍은 점이 삭제됩니다.

**Q: 로그를 잘못 기록했어요.**  
A: `마지막 로그 삭제` 버튼을 클릭하면 가장 최근 로그가 삭제됩니다.

**Q: 패스 입력 시 좌표가 왜 2개 필요한가요?**  
A: 시작점(패스한 위치)과 끝점(패스 받은 위치)을 모두 기록하여 패스 거리와 방향을 분석합니다.

**Q: Progressive Pass가 자동으로 안 붙는데요?**  
A: Direction(공격 방향) 설정을 확인하고, 골라인 방향으로 10m 이상 전진했는지 확인하세요.

**Q: 시간이 자동으로 증가하지 않아요.**  
A: 현재 버전은 수동 시간 입력 방식입니다. 화살표 키나 +1분/-1분 버튼으로 조정하세요.

---

## 기술 지원

문제가 발생하거나 기능 개선 제안이 있으시면:
- GitHub Issues: [프로젝트 저장소](https://github.com/Yoonsh0214/FPA_Streamlit_App)

---

**📝 마지막 업데이트**: 2025-12-02  
**버전**: 1.1.0
